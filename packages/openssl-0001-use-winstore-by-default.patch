From e0237d629397d6732fd91276f6af19cc7061f683 Mon Sep 17 00:00:00 2001
From: Andarwinux <Andarwinux@users.noreply.github.com>
Date: Fri, 8 Aug 2025 00:00:00 +0000
Subject: [PATCH] use winstore by default

---
 crypto/x509/by_store.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/crypto/x509/by_store.c b/crypto/x509/by_store.c
index 3fa3471..e04b335 100644
--- a/crypto/x509/by_store.c
+++ b/crypto/x509/by_store.c
@@ -130,6 +130,10 @@ static int by_store_ctrl_ex(X509_LOOKUP *ctx, int cmd, const char *argp,
 {
     switch (cmd) {
     case X509_L_ADD_STORE:
+#ifdef _WIN32
+        if (argp == NULL)
+            argp = "org.openssl.winstore://";
+#endif
         if (argp != NULL) {
             STACK_OF(CACHED_STORE) *stores = X509_LOOKUP_get_method_data(ctx);
             CACHED_STORE *store = OPENSSL_zalloc(sizeof(*store));
-- 
2.50.1

